function objectToParams(e){var a=Object.keys(e);a.sort();var t="";return a.forEach(function(a){e[a]&&(t+="&"+a+"="+e[a])}),t.substring(1)}function addNews(e){var a=e.link,t=(e.categories,e.date),s=new Date(t).toDateString(),o=e.title.rendered,r=s.split(" ").splice(1);s=r[0]+" "+r[1]+", "+r[2];var c="";e._embedded["wp:featuredmedia"]&&(c=e._embedded["wp:featuredmedia"][0].source_url),$(".recent-news-wrapper").append("<a class='news-wrapper col-xl-4' href='"+a+"'><div class='news-box' id='news-"+e.id+"'><div class='news-title'>"+o+"</div></div></a>"),$("#news-"+e.id).css("background","linear-gradient(0deg, rgba(52, 73, 94, 0.40), rgba(52, 73, 94, 0.40)),url("+c+")")}function addPost(e,a){var t=e.link,s=e.categories,o=authors[e.author],r=e.date,c=new Date(r).toDateString(),n=c.split(" ").splice(1),d=o.name;c=n[0]+" "+n[1]+", "+n[2];var i="";s.forEach(function(e){1!=e&&e!=chineseCategory&&e!=englishCategory&&e!=featuredCategory&&(i+="<a href='blog/?categories="+e+"' l>"+cats[e].name+"</a>, ")}),"http://0.gravatar.com/avatar/cbf3ae80bfffa54eade6fba665324a26?s=92&d=mm&r=g"!=o.avatar_urls[96]&&"https://secure.gravatar.com/avatar/8a2233e4af05d90078be153329a99004?s=96&d=mm&r=g"!=o.avatar_urls[96]||(o.avatar_urls[96]="/assets/images/defaultavatar.jpg");var l="<div class='col-md-6'><div class='post'><a href='"+t+"' class='post-title-wrapper'><h2 class='post-title'>"+e.title.rendered+"</h2></a><img src='"+o.avatar_urls[96]+"' class='post-author-avatar' alt='"+d+"&#39;s Avatar'><div class='post-meta'><cite class='post-author'><span>"+d+"</span></cite><br><time class='post-time'>"+c+"</time><span class='post-slash'> / </span><h3 class='post-tags'>"+i.substring(0,i.length-2)+"</h3><time class='post-time'></time></div><div class='post-desc'>"+e.excerpt.rendered+"</div>";l+="<div class='social-media'><a href='https://twitter.com/share?url="+t+"' target='_blank'><ion-icon name='logo-twitter'></ion-icon></a><a href='#' target='_blank'><ion-icon name='logo-reddit'></ion-icon></a><a href='https://www.facebook.com/sharer.php?u="+t+"' target='_blank'><ion-icon name='logo-facebook'></ion-icon></a><a href='#'></a></div>",l+="</div></div>",$("#content-5").append(l)}var excludedLangs=allSiteLangs,excludedLangsArr=excludedLangs=excludedLangs.filter(function(e){return e!=siteLang}).map(function(e){return siteLangMap[e]}),cachemethod="default",c0="wp-json/wp/v2/posts?categories_exclude="+(excludedLangs=excludedLangs.join(","))+"&categories="+featuredCategory+"&page=1&per_page=100";cachemethod=cacheable["/"+c0]||cacheable["/blog/"+c0]?"force-cache":"default";var featuredPostsPromise=fetch("/blog/"+c0,{cache:cachemethod}).then(function(e){return e.json()}),c1="wp-json/wp/v2/categories";cachemethod=cacheable["/"+c1]||cacheable["/blog/"+c1]?"force-cache":"default";var catsPromise=fetch("/blog/wp-json/wp/v2/categories",{cache:cachemethod}).then(function(e){return e.json()}),cats={},featuredPosts=[],added={},featuredPostsPromiseArr=[],authors={},paramsPost={categories:externalNewsCategory,per_page:"9",_embed:"a"},c3="wp-json/wp/v2/posts?"+objectToParams(paramsPost);cachemethod=cacheable["/"+c3]||cacheable["/blog/"+c3]?"force-cache":"default";var ha=new Headers;ha.append("Cache-Control","public, max-age=1200"),newsPostsPromise=fetch(wp_endpoint+c3,{headers:ha}).then(function(e){var a=e.headers;return totalPages=parseInt(a.get("X-WP-TotalPages")),e.json()});var newsposts={};$(document).ready(function(){Promise.all([newsPostsPromise,catsPromise]).then(function(e){newsposts=[e[0][0],e[0][1],e[0][2]],e[1].forEach(function(e){cats[e.id]=e})}).then(function(){newsposts.forEach(function(e){e.categories.forEach(function(a){a==externalNewsCategory&&addNews(e)})})})}),$(document).ready(function(){Promise.all([featuredPostsPromise,catsPromise]).then(function(e){featuredPosts=e[0],e[1].forEach(function(e){cats[e.id]=e})}).then(function(e){featuredPosts.forEach(function(e){if(added[e.id]=!1,authors.hasOwnProperty(e.author))0==added[e.id]&&(addPost(e),added[e.id]=!0);else{var a="wp-json/wp/v2/users/"+e.author;cachemethod=cacheable["/"+a]||cacheable["/blog/"+c1]?"force-cache":"default",fetch(wp_endpoint+"wp-json/wp/v2/users/"+e.author,{cache:cachemethod}).then(function(e){return e.json()}).then(function(a){authors[e.author]=a,0==added[e.id]&&(addPost(e),added[e.id]=!0,$(".blank-placeholder-posts").css("display","none"))})}})})});