function setAnnouncement(n){if(localStorage.getItem("lastClosedAnnouncementID")!=n.id){var e=n.content.rendered;$("#announcement-wrapper").css("display","block"),$("#announcement-content").html(e),$(".content-wrapper").css("margin-top","calc(4.6rem + 25px + 0.5rem)"),$(".navbar").css("top","calc(25px + 0.5rem)"),$("#close-announcement").on("click",function(){removeAnnouncement(n)})}}function removeAnnouncement(n){$("#announcement-wrapper").css("display","none"),$(".content-wrapper").css("margin-top","4.6rem"),$(".navbar").css("top","0px"),localStorage.setItem("lastClosedAnnouncementID",n.id)}function popup(n,e,a){Object.keys(n).forEach(function(e){var a=e.replace("_","-");$("#popup").css(a,n[e])}),$("#popup-title").css("background-color","var(--b1)"),$("#popup-title-text").text(e),$("#popup-content").html(a),$("#popup").css("display","block"),$("#popup-page-cover").css("display","block"),setTimeout(function(){$("#popup-page-cover").css("opacity","1"),$("#popup").css("opacity","1")},50)}function popdown(){$("#popup-page-cover").css("opacity","0"),$("#popup").css("opacity","0"),setTimeout(function(){$("#popup").css("display","none"),$("#popup-page-cover").css("display","none")},500)}function bannerup(n,e){var a=bannerID;bannerID+=1,$(".banner-wrapper").append("<div class='banner' id='banner-"+a+"'><span class='close-banner' onclick='bannerdown("+a+")'><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' width='32' height='32'><path fill='#fefefe' d='M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z' /></svg></span><div class='banner-content'></div></div>"),$("#banner-"+a+" .banner-content").append(e)}function bannerdown(n){$("#banner-"+n).remove()}function subscribeEmail(n,e){$("#"+e+" .sub-load").css("display","inline-block"),$("#"+e+" .sub-btn").css("display","none"),$.post(globalSiteRoot+"assets/globalscripts/subscribe.php",{email:n,lang:siteLang}).done(function(n){var a=JSON.parse(n)[0];a.status,bannerup("","<span>"+a.message+"</span>"),$("#"+e+" .sub-btn").css("display","inline-block"),$("#"+e+" .sub-load").css("display","none")})}function validateEmail(n){return/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/g.test(n)}var timerToToggleMenu,chosenLang,menuDisplayed=!1;$(document).ready(function(){if(setTimeout(function(){$(".siteloadbar").css("opacity","0"),$(".siteloadbar2").css("opacity","0"),setTimeout(function(){$(".siteloadbar2").css("display","none"),$(".siteloadbar").css("display","none")},1e3)},2100),$("#email-input").on("focus",function(){$(document).off("keyup"),$(document).keyup(function(n){if('"Enter'==n.key)return $("#subscribe-email").click(),!1})}),$(document).keyup(function(n){"Escape"===n.key&&popdown()}),$("#menu-button").on("click",function(){!0!==menuDisplayed||$("#navbarSupportedContent").hasClass("collapsing")?!1!==menuDisplayed||$("#navbarSupportedContent").hasClass("collapsing")||(menuDisplayed=!0,$("#page-cover").css("top","0px"),$("#menu-bar").css("display","none"),$("#close-bar").css("display","block")):(menuDisplayed=!1,$("#page-cover").css("top","-100vh"),$("#menu-bar").css("display","block"),$("#close-bar").css("display","none"))}),chosenLang=localStorage.getItem("taosdata.com-lang"),console.log("L:"+chosenLang),null==chosenLang){var n=navigator.language||navigator.userLanguage;chosenLang=(chosenLang=n).substr(0,2),localStorage.setItem("taosdata.com-lang",chosenLang)}chosenLang.substr(0,2),$("#select-en").on("click",function(){var n=window.location.href.substr(0,30).replace(/cn/,"en");window.location=n+window.location.href.substring(30,window.location.href.length),localStorage.setItem("taosdata.com-lang","en")}),$("#select-cn").on("click",function(){var n=window.location.href.substr(0,30).replace(/en/,"cn");window.location=n+window.location.href.substring(30,window.location.href.length),localStorage.setItem("taosdata.com-lang","cn")}),$(".wechat-social").on("click",function(){"en"==siteLang?popup({width:"calc(100% - 40px)",max_width:"300px"},"WeChat Account",'<img style="width:100%;" src="/assets/images/taosdataqrcode.png">'):"cn"==siteLang&&popup({width:"calc(100% - 40px)",max_width:"300px"},"微信公众号",'<img style="width:100%;" src="/assets/images/taosdataqrcode.png">')}),$("#subscribe-email").on("click",function(n){n.preventDefault();var e=$("#email-input").val();if(validateEmail(e)){subscribeEmail(e,"email-subscribe-form");$("#email-input").removeClass("invalid-input"),$("#email-input").addClass("valid-input"),document.getElementById("email-input").setCustomValidity("")}else document.getElementById("email-input").setCustomValidity("Invalid email"),$("#email-input").addClass("invalid-input"),document.getElementById("email-input").reportValidity();return!1}),$("#email-input").on("keydown",function(){document.getElementById("email-input").setCustomValidity("")});var e=englishCategory;"en"==siteLang&&(e=chineseCategory),fetch(wp_endpoint+"wp-json/wp/v2/posts?categories="+announcementCategory).then(function(n){return n.json()}).then(function(n){if(n.length)for(var a=0;a<n.length;a++)if(-1==n[a].categories.indexOf(e)){console.log(n[a].categories,e),setAnnouncement(n[a]);break}})});var bannerID=1;