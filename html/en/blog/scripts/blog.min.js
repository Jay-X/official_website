"use strict";function objectToParams(e){var a=Object.keys(e);a.sort();var t="";return a.forEach(function(a){e[a]&&(t+="&"+a+"="+e[a])}),t.substring(1)}function addPageNum(e){var a={categories:categoryquery,tags:tagquery,search:searchquery,per_page:"5",sticky:"true",page:e};$("#pagination").append("<a class='page-num' id='page-"+e+"' href='?"+objectToParams(a)+"'><button class='btn btn-primary'>"+e+"</button></a>")}var tagsPromise,authorPromise,postsPromise,tagquery,categoryquery,posts={},authors={},tags={},cats={},js_tagsArr=[],js_catsArr=[],searchquery="",pageQuery="",filterCategories=[];""!==js_tags&&(tagquery=js_tags,js_tagsArr=js_tags.split(",")),""!==js_categories&&(categoryquery=js_categories),""!==js_searchKey&&(searchquery=js_searchKey),""!==js_page&&(pageQuery=js_page);var totalPages,page=1,searchedTags=js_tags.split(","),cachemethod="default",c0="wp-json/wp/v2/categories";cachemethod=cacheable["/"+c0]||cacheable["/blog/"+c0]?"force-cache":"default";var ha=new Headers;ha.append("Cache-Control","public, max-age=1200");var catsPromise=fetch(wp_endpoint+c0,{headers:ha}).then(function(e){return e.json()}),excludedLangs=allSiteLangs,excludedLangsArr=excludedLangs=excludedLangs.filter(function(e){return e!=siteLang}).map(function(e){return siteLangMap[e]}),paramsStickyPost={categories_exclude:(excludedLangs=excludedLangs.join(","))+","+externalNewsCategory+","+announcementCategory,categories:categoryquery,tags:tagquery,search:searchquery,per_page:"5",sticky:"true"},c1="wp-json/wp/v2/posts?"+objectToParams(paramsStickyPost);cachemethod=cacheable["/"+c1]||cacheable["/blog/"+c1]?"force-cache":"default";var stickyPostsPromise=fetch(wp_endpoint+c1,{headers:ha}).then(function(e){return e.json()}),paramsPost={categories_exclude:excludedLangs+","+externalNewsCategory+","+announcementCategory,categories:categoryquery,tags:tagquery,search:searchquery,per_page:"5",page:pageQuery},c2="wp-json/wp/v2/posts?"+objectToParams(paramsPost);cachemethod=cacheable["/"+c2]||cacheable["/blog/"+c2]?"force-cache":"default",postsPromise=fetch(wp_endpoint+c2,{headers:ha}).then(function(e){var a=e.headers;return totalPages=parseInt(a.get("X-WP-TotalPages")),""!==js_page&&(page=parseInt(js_page)),e.json()});var c3="wp-json/wp/v2/users";cachemethod=cacheable["/"+c3]||cacheable["/blog/"+c3]?"force-cache":"default",$(document).ready(function(){$("#blog-href").addClass("active"),$("#long-email").on("focus",function(){$(document).off("keypress"),$(document).keypress(function(e){if(13==e.which)return $("#long-form-submit").click(),!1})}),$("#searchKey").on("focus",function(){$(document).off("keypress"),$(document).keypress(function(e){if(13==e.which)return search(),!1})});var e=[catsPromise,postsPromise,stickyPostsPromise];Promise.all(e).then(function(e){var a=js_categories.split(",");e[0].forEach(function(e){cats[e.id]=e;for(var t=!1,s=0;s<a.length;s++)if(e.id==parseInt(a[s])){t=!0;break}addTag(e.id,t)}),a.forEach(function(e){$("#tag-"+e).addClass("selected")}),posts=e[1];var t=e[2];if(void 0==t&&(t=[]),isNaN(totalPages))return $(".blank-placeholder-posts").css("display","none"),void $("#posts-list").append("<h3>No posts returned, click <a l href='../blog'>here</a> to go back to the blog home page</h3>");if(posts.length>0){var s=0;if(posts.forEach(function(e){authors[e.author]?(s+=1)==posts.length&&(posts.forEach(function(e){addPost(e)}),$(".blank-placeholder-posts").css("display","none")):fetch(wp_endpoint+c3+"/"+e.author,{headers:ha}).then(function(e){return e.json()}).then(function(e){return authors[e.id]=e}).then(function(e){(s+=1)==posts.length&&(posts.forEach(function(e){addPost(e)}),$(".blank-placeholder-posts").css("display","none"))})}),page>1&&1!=totalPages){var o={categories:categoryquery,tags:tagquery,search:searchquery,per_page:"5",sticky:"true",page:page-1};$("#pagination").append("<a class='page-num' id='page-"+(page-1)+"' href='?"+objectToParams(o)+"'><button class='btn btn-primary'>Prev</button></a>")}if(totalPages<=7)for(var r=1;r<totalPages+1;r++)addPageNum(r);else if(page==totalPages){addPageNum(1),addPageNum(2),$("#pagination").append("<a class='ellipsis'>...</a>");for(var n=totalPages-3;n<=totalPages;n++)addPageNum(n)}else if(page<totalPages-3&&page>3){addPageNum(1),addPageNum(2),$("#pagination").append("<a class='ellipsis'>...</a>");for(var c=page-1;c<=page+1;c++)addPageNum(c);$("#pagination").append("<a class='ellipsis'>...</a>"),addPageNum(totalPages-1),addPageNum(totalPages)}else if(page>=totalPages-3){addPageNum(1),addPageNum(2),$("#pagination").append("<a class='ellipsis'>...</a>");for(var g=totalPages-(totalPages-page+1);g<=totalPages;g++)addPageNum(g)}else if(page<=3){for(var i=1;i<=page+1;i++)addPageNum(i);$("#pagination").append("<a class='ellipsis'>...</a>"),addPageNum(totalPages-1),addPageNum(totalPages)}if(page<totalPages&&1!=totalPages){var l={categories:categoryquery,tags:tagquery,search:searchquery,per_page:"5",sticky:"true",page:page+1};$("#pagination").append("<a class='page-num' id='page-"+(page+1)+"' href='?"+objectToParams(l)+"'><button class='btn btn-primary'>Next</button></a>")}$("#page-"+page+" button").removeClass("btn-primary"),$("#page-"+page+" button").addClass("btn-filled")}else $(".blank-placeholder-posts").css("display","none"),$("#posts-list").append("<h3>No posts returned, click <a l href='../blog'>here</a> to go back to the blog home page</h3>")}),$("#long-form-submit").on("click",function(e){e.preventDefault();var a=$("#long-email").val();if(validateEmail(a)){subscribeEmail(a,"long-email-subscribe-form");$("#long-email").removeClass("invalid-input"),$("#long-email").addClass("valid-input"),document.getElementById("long-email").setCustomValidity("")}else document.getElementById("long-email").setCustomValidity("Invalid email"),$("#long-email").addClass("invalid-input"),document.getElementById("long-email").reportValidity();return!1}),$("#long-email").on("keydown",function(){document.getElementById("long-email").setCustomValidity("")})});